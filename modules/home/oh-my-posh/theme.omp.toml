#:schema https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/schema.json

# Oh My Posh - Rose Pine Theme
#
# Rose Pine (main) palette reference:
#   base:           #191724    surface:  #1f1d2e    overlay:  #26233a
#   muted:          #6e6a86    subtle:   #908caa    text:     #e0def4
#   love:           #eb6f92    gold:     #f6c177    rose:     #ebbcba
#   pine:           #31748f    foam:     #9ccfd8    iris:     #c4a7e7
#   highlight_low:  #21202e    highlight_med: #403d52    highlight_high: #524f67

version = 3
final_space = true

# ── Left-aligned prompt ──────────────────────────────────────────────
[[blocks]]
  type = "prompt"
  alignment = "left"

  # OS / Hostname
  [[blocks.segments]]
    type = "os"
    style = "diamond"
    leading_diamond = "\ue0b6"
    background = "#26233a"
    foreground = "#31748f"
    template = "{{ .Icon }} {{ .HostName }} "

  # Working directory
  [[blocks.segments]]
    type = "path"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#eb6f92"
    foreground = "#191724"
    template = " \uf07b \uea9c {{ .Path }} "

    [blocks.segments.properties]
      folder_icon = "\uf115"
      folder_separator_icon = " \ue0b1 "
      home_icon = "\ueb06"
      style = "full"

  # Git
  [[blocks.segments]]
    type = "git"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#ebbcba"
    background_templates = [
      "{{ if or (.Working.Changed) (.Staging.Changed) }}#f6c177{{ end }}",
      "{{ if and (gt .Ahead 0) (gt .Behind 0) }}#c4a7e7{{ end }}",
      "{{ if gt .Ahead 0 }}#31748f{{ end }}",
      "{{ if gt .Behind 0 }}#eb6f92{{ end }}",
    ]
    foreground = "#191724"
    template = " {{ .UpstreamIcon }}\ue0a0 {{ .HEAD }}{{ if .Staging.Changed }} \uf046 {{ .Staging.String }}{{ end }}{{ if and (.Working.Changed) (.Staging.Changed) }} |{{ end }}{{ if .Working.Changed }} \uf044 {{ .Working.String }}{{ end }}{{ if gt .StashCount 0 }} \ueb4b {{ .StashCount }}{{ end }} "

    [blocks.segments.properties]
      fetch_status = true
      fetch_upstream_icon = true

  # Python
  [[blocks.segments]]
    type = "python"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#f6c177"
    foreground = "#191724"
    template = " \ue73c {{ if .Venv }}{{ .Venv }} {{ end }}{{ .Full }} "

  # Go
  [[blocks.segments]]
    type = "go"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#9ccfd8"
    foreground = "#191724"
    template = " \ue627 {{ .Full }} "

  # Rust
  [[blocks.segments]]
    type = "rust"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#eb6f92"
    foreground = "#191724"
    template = " \ue7a8 {{ .Full }} "

  # Node.js
  [[blocks.segments]]
    type = "node"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#31748f"
    foreground = "#e0def4"
    template = " \ue718 {{ if .PackageManagerIcon }}{{ .PackageManagerIcon }} {{ end }}{{ .Full }} "

  # Docker
  [[blocks.segments]]
    type = "docker"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#908caa"
    foreground = "#191724"
    template = " \uf308 {{ .Context }} "

  # Shell
  [[blocks.segments]]
    type = "shell"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#6e6a86"
    foreground = "#e0def4"
    template = " \uf313 {{ .Name }} "

    [blocks.segments.properties]
      mapped_shell_names = { "nix-shell" = "nix" }

  # Execution time
  [[blocks.segments]]
    type = "executiontime"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#c4a7e7"
    foreground = "#191724"
    template = " \ueba2 {{ .FormattedMs }} "

    [blocks.segments.properties]
      always_enabled = true

  # Battery
  [[blocks.segments]]
    type = "battery"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#31748f"
    background_templates = [
      "{{ if lt .Percentage 20 }}#eb6f92{{ end }}",
      "{{ if and (ge .Percentage 20) (lt .Percentage 50) }}#f6c177{{ end }}",
    ]
    foreground = "#e0def4"
    foreground_templates = [
      "{{ if lt .Percentage 50 }}#191724{{ end }}",
    ]
    template = " {{ if not .Error }}{{ .Icon }}{{ .Percentage }}{{ end }} "

    [blocks.segments.properties]
      charged_icon = "\uf583 "
      charging_icon = "\uf5e7 "
      discharging_icon = "\uf582 "

  # Time
  [[blocks.segments]]
    type = "time"
    style = "powerline"
    powerline_symbol = "\ue0b0"
    background = "#9ccfd8"
    foreground = "#191724"
    template = " \uf017 {{ .CurrentDate | date .Format }} "

    [blocks.segments.properties]
      time_format = "3:04 PM"

  # Exit status
  [[blocks.segments]]
    type = "status"
    style = "diamond"
    powerline_symbol = "\ue0b0"
    trailing_diamond = "\ue0b4"
    background = "#31748f"
    background_templates = [
      "{{ if gt .Code 0 }}#eb6f92{{ end }}",
    ]
    foreground = "#e0def4"
    template = " {{ if gt .Code 0 }}\uf421{{ else }}\uf469{{ end }} "

    [blocks.segments.properties]
      always_enabled = true

# ── Second line ──────────────────────────────────────────────────────
[[blocks]]
  type = "prompt"
  alignment = "left"
  newline = true

  # Root indicator (only visible as root)
  [[blocks.segments]]
    type = "root"
    style = "plain"
    foreground = "#eb6f92"
    template = "\ue3bf "

  # Prompt character
  [[blocks.segments]]
    type = "text"
    style = "plain"
    foreground = "#908caa"
    template = " <#9ccfd8><b>\uf0e7</b></><b>{{ .UserName }}</b> <#31748f>\uf054</><#9ccfd8>\uf054</>"

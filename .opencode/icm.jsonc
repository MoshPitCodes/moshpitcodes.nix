{
  "$schema": "./icm.schema.json",
  // Intelligent Context Manager configuration
  // See icm.schema.json for all options

  // Enable or disable the plugin
  "enabled": true,

  // Enable debug logging to .opencode/logs/icm_debug.jsonl
  "debug": false,

  // Notification display: "off", "minimal", or "detailed"
  "pruneNotification": "detailed",

  // Notification type: "chat" (in-conversation) or "toast" (system toast)
  "pruneNotificationType": "chat",

  // LLM-driven context pruning tools
  "tools": {
    "settings": {
      // Nudge the LLM to use pruning tools periodically
      "nudgeEnabled": true,
      "nudgeFrequency": 10,
      // Token limit triggering compress nudge (number or "X%" of model window)
      "contextLimit": 100000
    },
    "distill": {
      "permission": "allow"
    },
    "compress": {
      // Disabled by default â€” enable with "allow" or "ask"
      "permission": "deny"
    },
    "prune": {
      "permission": "allow"
    }
  },

  // Automatic pruning strategies (zero LLM cost)
  "strategies": {
    "deduplication": {
      "enabled": true,
      // 0.92 = near-identical; set to 1.0 to disable fuzzy matching
      "fuzzyThreshold": 0.92
    },
    "supersedeWrites": {
      "enabled": true
    },
    "purgeErrors": {
      "enabled": true,
      "turns": 4
    },
    "smartCompression": {
      "enabled": true,
      // Only compress outputs longer than 2000 chars
      "minLength": 2000,
      // Extract and preserve code structure (imports, exports, functions)
      "preserveStructure": true
    }
  },

  // Semantic analysis for intelligent pruning
  "semantic": {
    "enabled": true,
    "trackDependencies": true,
    "decayRate": 0.05
  },

  // Cross-session memory
  "memory": {
    "enabled": true,
    "learnPrunePatterns": true
  },

  // Cache-aware pruning to minimize prompt cache invalidation
  "cacheAwareness": {
    "enabled": true,
    "provider": "auto",
    "minNetSavings": 500
  }
}
